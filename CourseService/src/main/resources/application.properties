# General Configuration
spring.application.name=courseService
server.port=8080

# Disable Auto-Configuration for DataSource
spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration

# MongoDB Configuration
# spring.data.mongodb.host=course_service_db
# spring.data.mongodb.port=27018
# spring.data.mongodb.database=course_service
#spring.data.mongodb.uri=mongodb+srv://username:password@cluster0.mongodb.net/?retryWrites=true&w=majority&appName=Cluster0
spring.data.mongodb.uri=mongodb://username:password@localhost:27017/course_service?authSource=admin
spring.data.mongodb.auto-index-creation=true
spring.main.allow-bean-definition-overriding=true
spring.data.mongodb.auditing.enabled=true

# Redis Configuration
spring.data.redis.host=localhost
spring.data.redis.port=6379
spring.data.redis.password=your_redis_password
spring.data.redis.ssl.enabled=false
spring.data.redis.timeout=10000
spring.data.redis.connect-timeout=10000
spring.data.redis.lettuce.pool.max-active=8
spring.data.redis.lettuce.pool.max-idle=8
spring.data.redis.lettuce.pool.min-idle=2
spring.data.redis.lettuce.pool.max-wait=3000
spring.data.redis.lettuce.shutdown-timeout=5000

# Logging Configuration
logging.level.org.springframework.data.redis=DEBUG
logging.level.io.lettuce.core=DEBUG
logging.level.org.apache.coyote.http11=WARN
logging.level.org.apache.tomcat=WARN
logging.level.org.apache.catalina=WARN

# AWS S3 Configuration
cloud.aws.credentials.access-key=AKIAIOSFODNN7EXAMPLE
cloud.aws.credentials.secret-key=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY
cloud.aws.credentials.region=ap-south-1
application.bucket.name=your-s3-bucket
application.bucket.temp-prefix=temp
application.bucket.chunk-size=5242880
aws.s3.bucket=your-bucket-name
aws.s3.temp-storage-prefix=temp/
aws.s3.chunk-size=5242880

# RabbitMQ Configuration
spring.rabbitmq.host=localhost
spring.rabbitmq.port=5672
spring.rabbitmq.username=your_rabbitmq_user
spring.rabbitmq.password=your_rabbitmq_password
spring.amqp.deserialization.trust.all=true

# User Service API
user.service.api.key=https://your-user-service.example.com

# Student Service API
student.service.api.url=http://student-service

# Temporary upload directory
app.upload.temp-dir=${java.io.tmpdir}/course-uploads

# File upload configuration
spring.servlet.multipart.max-file-size=1000MB
spring.servlet.multipart.max-request-size=1000MB
spring.servlet.multipart.enabled=true
spring.servlet.multipart.file-size-threshold=2MB

server.tomcat.connection-timeout=180000
server.tomcat.max-http-form-post-size=1000MB
server.tomcat.max-swallow-size=1000MB
server.tomcat.max-http-post-size=1000MB
server.tomcat.keep-alive-timeout=120000
server.tomcat.max-connections=10000
server.tomcat.accept-count=100

# Thread pool settings
server.tomcat.threads.max=200
server.tomcat.threads.min-spare=10

# Additional connection settings that might help
server.tomcat.relaxed-query-chars=|,{,},[,]
server.tomcat.relaxed-path-chars=|,{,},[,]
server.tomcat.uri-encoding=UTF-8

# Error handling
server.error.include-message=always
server.error.include-binding-errors=always
server.error.include-stacktrace=never

# HTTP settings
spring.mvc.async.request-timeout=180000

# Actuator endpoints
management.endpoints.web.exposure.include=health,metrics,prometheus
management.endpoint.health.show-details=always
management.health.circuitbreakers.enabled=true
management.health.redis.enabled=true
management.health.rabbit.enabled=true
management.metrics.tags.application=${spring.application.name}

# Logging configuration
logging.level.org.springframework.web.filter.CommonsRequestLoggingFilter=DEBUG
logging.level.org.springframework.web=INFO
logging.level.org.springframework.amqp=INFO
logging.level.org.springframework.data=INFO
logging.level.io.lettuce=INFO
logging.level.org.apache.coyote.http11=WARN
logging.level.org.apache.tomcat=WARN
logging.level.org.apache.catalina=WARN

# Circuit Breaker configuration
resilience4j.circuitbreaker.instances.default.registerHealthIndicator=true
resilience4j.circuitbreaker.instances.default.slidingWindowSize=10
resilience4j.circuitbreaker.instances.default.minimumNumberOfCalls=5
resilience4j.circuitbreaker.instances.default.permittedNumberOfCallsInHalfOpenState=3
resilience4j.circuitbreaker.instances.default.automaticTransitionFromOpenToHalfOpenEnabled=true
resilience4j.circuitbreaker.instances.default.waitDurationInOpenState=5s
resilience4j.circuitbreaker.instances.default.failureRateThreshold=50
resilience4j.circuitbreaker.instances.default.eventConsumerBufferSize=10

server.address=0.0.0.0

# Jackson Configuration
spring.jackson.serialization.FAIL_ON_EMPTY_BEANS=false
spring.jackson.serialization.WRITE_DATES_AS_TIMESTAMPS=false
spring.jackson.default-property-inclusion=non_null
spring.jackson.deserialization.FAIL_ON_UNKNOWN_PROPERTIES=false
spring.jackson.mapper.DEFAULT_VIEW_INCLUSION=true
spring.jackson.serialization.WRITE_ENUMS_USING_TO_STRING=true
spring.jackson.deserialization.READ_ENUMS_USING_TO_STRING=true
spring.jackson.serialization.INDENT_OUTPUT=false
spring.jackson.serialization.WRITE_BIGDECIMAL_AS_PLAIN=true